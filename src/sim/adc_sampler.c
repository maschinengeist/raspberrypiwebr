/*! \file adc_sampler.c
*/

#ifdef __cplusplus
	extern "C" {
#endif

/*************************************************************************
*   I N C L U D E
*************************************************************************/


#include "mytypes.h"
#include "adc_sampler.h"

/*************************************************************************
*   D E F I N E
*************************************************************************/

#define ADC_SAMPLE_SIZE 512

/*************************************************************************
*   G L O B A L
*************************************************************************/

static INT_U16 u16AdcSample[ADC_SAMPLE_SIZE];
static INT_U8  u08SampleState = 0;
static INT_U8  u08Sinus[] = {0,2,8,17,30,45,64,84,105,127,149,170,191,209,224,237,246,252,254,252,246,237,224,209,191,170,149,127,105,84,64,45,30,17,8,2,
                                0,2,8,17,30,45,64,84,105,127,149,170,191,209,224,237,246,252,254,252,246,237,224,209,191,170,149,127,105,84,64,45,30,17,8,2,
                                0,2,8,17,30,45,64,84,105,127,149,170,191,209,224,237,246,252,254,252,246,237,224,209,191,170,149,127,105,84,64,45,30,17,8,2,
                                0,2,8,17,30,45,64,84,105,127,149,170,191,209,224,237,246,252,254,252,246,237,224,209,191,170,149,127,105,84,64,45,30,17,8,2,
                                0,2,8,17,30,45,64,84,105,127,149,170,191,209,224,237,246,252,254,252,246,237,224,209,191,170,149,127,105,84,64,45,30,17,8,2};

/*************************************************************************
*   F O R W A R D   D E C L A R A T I O N
*************************************************************************/

/************************************************************************
*/
/*! \fn void Adc_SamplerInit(void)
*
*   \brief init gpio and timer
*
*************************************************************************/
void Adc_SamplerInit(void)
{

}

/************************************************************************
*/
/*! \fn void Adc_SamplerStart(INT_U16 u16SampleTime, INT_U16 u16SampleLength, INT_U8 u08TriggerChannel)
*
*   \brief start an sample with the parameters given in the function
*
*************************************************************************/
void Adc_SamplerStart(FLOAT fVoltage, INT_U8 u08SampleTime, INT_U16 u16SampleLength, INT_U8 u08TriggerEdge, INT_U8 u08TriggerChannel)
{
   INT_U8 u08Loop;
   INT_U16 u16Loop;

   /* sampler is ready */
   u08SampleState = 1;

   for(u16Loop = 0 ; u16Loop < 512 ; u16Loop++)
   {
      u16AdcSample[u16Loop] = u08Sinus[u16Loop];//u08Loop & 0x00ff;
      u08Loop += 16;
      if(u16Loop & 0x10) u16AdcSample[u16Loop] += 0xff00;
   }

   Sleep(100);
}

/************************************************************************
*/
/*! \fn INT_U16 Adc_SamplerGetSample(INT_U16 u16SampleNr)
*
*   \brief
*
*************************************************************************/
INT_U16 Adc_SamplerGetSample(INT_U16 u16SampleNr)
{
   return u16AdcSample[u16SampleNr];
}




/************************************************************************
*/
/*! \fn void Adc_SamplerStop(void)
*
*   \brief init function for init the gpios and the dogm spi
*
*************************************************************************/
void Adc_SamplerStop(void)
{
   /* sampler is ready */
   u08SampleState = 1;
}


/************************************************************************
*/
/*! \fn INT_U8 Adc_SamplerFinish(void)
*
*   \brief
*
*************************************************************************/
INT_U8 Adc_SamplerFinish(void)
{
   return u08SampleState;
}


#ifdef __cplusplus
   }
#endif

